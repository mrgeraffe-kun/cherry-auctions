@startuml

title CherryAuctions Architecture Design (Deployment View)

skinparam componentStyle uml2

' Set colors for zones
skinparam node {
    BackgroundColor<<Public>> #F0FFF0
    BackgroundColor<<Private>> #FFF0F0
}

cloud "External Services" {
  [Google IDP\n(www.googleapis.com)] as Google
  [S3 Storage\n(s3.luny.dev)] as S3
  [CDN\n(cdn.luny.dev)] as CDN
  [PurelyMail\n(smtp.purelymail.com)] as SMTP
}

node "Public Network" <<Public>> {
  [Vue SPA\n(cherry-auctions.luny.dev)] as FE
  [Go Main Backend\n(api.cherry-auctions.luny.dev)] as BE
  [OpenSearch Dashboards\n(opensearch.luny.dev)] as OSD
}

node "Private Network (No Public DNS)" <<Private>> {
  database "Relational Postgres" as DB
  [Go Mail Server] as MailServer
  
  node "Logging Pipeline" {
    [FluentBit Daemon] as FB
    [OpenSearch] as OS
  }
}

' Connections and Protocols
FE --> BE : HTTPS / REST
FE --> Google : OAuth Redirect
FE --> CDN : Reads Assets

BE --> DB : Internal SQL
BE --> Google : Verify OAuth
BE --> S3 : Writes Assets
BE --> MailServer : Internal Queue
BE --> FB : Log Data

CDN --> S3 : Pulls Assets
MailServer --> SMTP : SMTP/TLS
FB --> OS : Forward Logs
OSD --> OS : Aggregates Data

footer
  Nodes in the red "Private Network" zone are unpublished and cannot be accessed by the Internet.
endfooter

@enduml
